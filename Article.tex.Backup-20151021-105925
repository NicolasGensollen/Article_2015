%&latex
%%----------------------------------------------------------------------
%% ieeepes_skel.tex
%%
%% Skeleton file for papers for the IEEE Power Engineering Society using
%% package ieeepes.
%%
%% Not copyrighted. Copy this file to a different name and fill in your
%% text.
%%
%% Volker Kuhlmann
%% c/o EEE Dept
%% University of Canterbury
%% Private Bag 4800
%% Christchurch, New Zealand
%% Email: KUHLMAV@ELEC.CANTERBURY.AC.NZ
%%
% 1.3  13Apr99  Updated for ieeepes 4.0.
% 1.2  16Nov95  Fixed discussion, closure. Added summary.
% 1.1  12Nov95  Finished first release.
% 1.02 09Nov95  Option PStimes.
% 1.0  07Nov95  Created.
%%----------------------------------------------------------------------
 
\documentclass[10pt,twoside%
                ,draft%         % comment this out for final version
        ]{article}


\usepackage[%
        %       psphotos,%      % uncomment those options you want
        %       photofit,%
        %       draft,%
        %       PStimes,%
        ]{ieeepes}


\title{Control of Prosumer Networks}

\author{
        N. Gensollen\\
        Institut Mines Telecom\\
        Saclay, France
\and
        V. Gauthier\\
        Institut Mines Telecom\\
        Saclay, France
}



\begin{document}


% This \maketitle command is required from ieeepes version 4.0, to make
% ieeepes work correctly with newer LaTeX versions.
\maketitle


\begin{abstract}
Put the text of your abstract here.
\end{abstract}



\section{Introduction}

Text for the first section.


\section{The Model}

In order to model this power grid, we use a coupled oscillator network model. Our objective is to achieve synchronization of the grid at the main frequency $ \Omega = 50 Hz $. Each oscillator i has a phase angle $ \delta_i $ and a frequency $ \dot{\delta}_i $. Therefore, we seek an equilibrium of the form : $ \forall i,\ \dot{\delta}_i = \Omega $. For convenience, we express the dynamic of the oscillators in terms of the deviations from the main frequency : $ \delta_i(t) = \Omega t + \theta_i(t) $ which gives $ \dot{\delta_i} = \Omega + \dot{\theta_i} $. Let $ \omega_i = \dot{\theta_i} $, such that $ \dot{\delta_i} = \Omega + \omega_i $. The equilibrium we seek is now : $ \forall i,\ \omega_i = 0 $

The objective is to translate the dynamics of the generators and machines into equations involving the phase angles and the frequencies. Generators and machines are composed of a turbine that dissipates energy at a rate proportional to the square of the angular velocity ($P_{diss} = FV \sim V^2 $ ) : 

\begin{equation}
  P_{diss, i}(t) = K_{Di}(\dot{\delta_i}(t))^2 
\end{equation}

where $ K_{Di} $ is the dissipation constant of entity i.

Furthermore, it also accumulates kinetic energy $ \frac{1}{2} I \left( \frac{ d \delta_i }{dt} \right)^2 $ at a rate : 

\begin{equation} 
P_{acc,i}(t) = \frac{1}{2}I_i\dfrac{d}{dt} \left( \dot{ \delta_i }(t)^2 \right)
\end{equation} 

where $ I_{i}$ is the moment of inertia of entity i. For simplicity, we consider that all entities have the same dissipation constants($K_D$) and moment of inertia (I).

The condition for the power transmission between i and j is that the two devices do not operate in phase : The phase difference between i and j is : $ \delta_j(t) - \delta_i(t) = \Omega t + \theta_j(t) - \Omega t - \theta_i(t) = \theta_j(t) - \theta_i(t) $.

The transmitted power along the line can thus be written as : 

\begin{equation}
 P_{transmitted} = - P_{ij}^{MAX} sin( \theta_j - \theta_i )
\end{equation}
  
with $ P_{ij}^{MAX} $ being the capacity of the line $(i,j)$. 

If i is connected to more than one other entities, this equation becomes : 

\begin{equation}
  P_{transmitted} = - \sum_{j \in \mathcal{N}_i} P_{ij}^{MAX} sin( \theta_j - \theta_i ) 
\end{equation}

Again, for simplicity, we consider in the following that all lines have the same capacity $ P^{MAX} $.

Each entity i is then described by a power balance equation of the type :

\begin{equation}
 P_{S,i}  =  P_{diss,i} + P_{acc,i} + P_{transmitted,i} 
\end{equation}

By substituting and re-arranging the terms, we obtain the following non-linear coupled system of equations :

\begin{equation}
\begin{array}{lll}
P_{S, i}  =  I \Omega \ddot{ \theta_i }  + \left[ I \ddot{ \theta_i } + 2 K_D \Omega \right] \dot{ \theta_i } + K_D \Omega^2 \\+ K_D \dot{ \theta_i }^2 - P^{MAX} \sum_{j \in \mathcal{N}_i} sin \left[ \theta_j - \theta_i \right] \end{array}
\end{equation}

This non linear equation is obviously not very practical. We now use some approximations based on the fact that we consider only small deviations from the main frequency : $ \dot{ \delta}_i \sim \Omega $ which means that $ \omega_i = \dot{\theta_i} << \Omega $, such that the squared term $ K_D \dot{\theta}_i^2 $ can be neglected.

We now assume that the rate at which energy is stored in the kinetic term is much less of the rate at which energy is dissipated by friction, a common condition for mechanical systems : $ \ddot{ \theta }_i  << \dfrac{2 K_D}{I} $

The equation can thus be simplified to :

\begin{equation}
 \ddot{ \theta_i } \sim \psi_i - \alpha \dot{ \theta_i } + K \sum_{j\neq i} g_{ji} sin \left[ \theta_j - \theta_i \right] 
\end{equation}

Where $ \alpha = \dfrac{2 K_D}{I} $ is the dissipation term, $ K = \frac{P^{MAX}}{I \Omega} $ is the coupling strength, $ \psi_i = \left[ \frac{P^i_{source}}{I \Omega} - \frac{K_D \Omega}{I} \right] $, and $ g_{ij} $ is the coefficient of the adjacency matrix G.

The dynamic is still non linear because of the sine coupling. Therefore, we also assume that the phase angle differences are small such that $ sin \left[ \theta_j - \theta_i \right] \sim \theta_j - \theta_i $. By using vector notations, the dynamic can be written in the following form :

\begin{equation}
\ddot{\theta} = \Psi - \alpha \dot{\theta} - KL\theta }
\end{equation}

Where L is the Laplacian matrix of the underlying topology :

\begin{equation}
L_{ij} = \left\{ \begin{array}{lll} k_i\ \ \ \ \,if\ i=j \\ -g_{ij}\  if\ i \neq j \end{array} \right. 
\end{equation}

where $ k_i $ is the degree of node i.

This is a continuous time second order linear system of $ N $ equations. We first transform this into a continuous time first order linear system of $ 2 N $ equations by introducing the following vector : $ X = \left( \begin{array}{c} \theta \\ \dot{\theta} \end{array} \right)$.

 We obtain the following system : 

\begin{equation}
 \dot{X} = \left( \begin{array}{cc} 0 & I \\ - KL & -\alpha I \end{array} \right) X + \left( \begin{array}{c} 0 \\ \Psi \end{array} \right)
\end{equation}
 
Which can be written in discrete time: 

\begin{equation} 
X(t+\Delta t) = M  X(t) +  \left( \begin{array}{c} 0 \\ \Psi \Delta t \end{array} \right)
\end{equation} 

With $ M = \left( \begin{array}{cc} I & I \Delta t \\ -KL \Delta t & (1-\alpha \Delta t) I \end{array} \right) $.

By setting $ Y(t) =  \left( \begin{array}{c} X(t) \\ 1 \end{array} \right) $, let the dynamic be :

\begin{equation}
 Y(t+\Delta t) = A Y(t) }
\end{equation}

With transition matrix A :

\begin{equation}
 A =   \left( \begin{array}{ccc} I & I \Delta t & 0 \\ -KL \Delta t & (1-\alpha \Delta t)I & \Psi \Delta t \\ 0&0&1 \end{array} \right)
\end{equation}

This is a linear discrete time system of $ 2 N + 1 $ equations. Note that the transition matrix A encodes all the system parameters, topology, and power distribution.


\section{Control and Submodularity}

\subsection{Submodularity}

In this section we provide a very brief introduction to what submodular functions are, and how their maximization could be achieved in reasonable time.

 A set function $ F:2^{V} \longrightarrow \Re $ defined over a finite set V is said to be submodular if it satisfies :

\begin{equation}
\forall S,T \in V,\ F(S) + F(T) \geq F(S \cup T) + F(S \cap T)
\end{equation}

Another equivalent definition is that for all sets $ X, Y \in V$, such that $ X \subseteq Y$ and for all element $ x \in V \setminus Y$,

\begin{equation}
F(X \cup \{ x \} ) - F(X) \geq F(Y \cup \{ x \} ) - F(Y)
\end{equation} 

This basically means that submodular functions exhibit a diminishing return property which makes them particularly interesting for optimization.

Finding the set $ S_k $ of size k that maximize a set function F is a difficult problem because the number of sets of size k grows exponentially with k. Therefore complete enumeration and evaluation is only a feasible solution on very small examples. Nevertheless, if the set function is submodular, a simple greedy heuristic returns a solution $ S_k^{\star} $ such that, in the worst case, $ \frac{F(S_k^{\star})}{F(S_k^{OPT})} \sim 63\%$ (where $ S_k^{OPT}$ is the best set of size k according to F). 

Since the evaluation of F can be costly, a well-known lazy-greedy variation has been proposed by Minoux in 19XX. This smart implementation uses the submodular structure of the marginal gains in order to reduce drastically the number of calls to F. This can results in several order of magnitudes speedups.

\subsection{Control}

In this section, we introduce basic tools from control theory and relate them to the submodular functions introduced above. Recall that our objective is to maintain a given state in a dynamical system even if perturbation of the power distribution occur. 

More precisely, we assume the control of a subset of the nodes that we call driver nodes. In our particular power grid situation, a driver node could be a controllable load, a ramping generator, or a battery. This control assumption modifies the dynamic in the following way :

\begin{equation}
 Y(t+\Delta t) = A Y(t) + B u(t) 
\end{equation}

Basically, B is an indicator of the driver nodes, and $ u(t) $ represents the control vector input at time t. The system is said to be controllable in T steps is it can be steered from any initial state $ Y_0 $ to any final state $ Y_f $ through a sequence of control inputs $ u(t) $. If the system is controllable, there might be more than one sequence of control inputs that could realize such a thing. Among all these possibilities, we are interested in the one that requires the minimum amount of energy. Let $ \mathcal{E} = \int_{t_0}^{t_0+T} \Vert u(t) \Vert^2 dt $ be the energy used for the control of the system.

It can be shown that the control input sequence that minimizes the control energy can be written as :

\begin{equation}
 u^{\star}(t) = B^T(A^T)^{T-t-1}W^{-1}(T)\nu(T)
\end{equation}
where $ \nu(T) = Y_f - A^T Y_0 $ is the difference between the desired final state and the final free state, and $W(T) = \sum_{k=0}^{T} A^k B B^T (A^T)^k $ is called the Gramian matrix of the system. The Gramian is a popular tool in control theory since it is deeply linked to the controllability of the system. It can indeed be shown that the system is controllable if and only if the gramian is not singular, and that its rank indicates the dimension of the controllable subspace. Besides, the minimum control energy associated with the inputs $ u^{\star}(t)$ can be written as :

\begin{equation}
 \mathcal{E}_{min} = \nu(T)^T W^{-1}(T) \nu(T)
\end{equation}

Not surprisingly, the control energy depends on the initial and final states as well as on the inverse of the Gramian. A key point to design a low consumption control is thus to understand the relations between the control node set and the Gramian matrix. In [], the authors introduce several Gramian-based metrics that have concrete meanings in terms of the system controllability. For example, the trace of the inverse Gramian ($ Tr[ W^{-1}(T)] $) quantifies the average control energy necessary to move the system around the state space. These metrics measures some notions of the control allowed by a given driver node set. But they can be understood the other way around : what drivers should one select as to optimize a given control-based metric ? 

Using the Gramian-based metric $ \mathcal{M} $, let $ F(S) =\mathcal{M}(W_S(T))$, where $ W_S(T) $  is the Gramian matrix based on the driver node set S. [] showed that for some metrics, F is a submodular set function. This means that, for these metrics, we can use the greedy heuristic discussed above in order to maximize F.

\section{Control of the Prosumer Network}


 Considering the dynamic of equation (), we notice that the gramian based on the transition matrix A is never invertible, meaning that the system should not be controllable. It is easy to see that, indeed, we do not have full control because of the last row of the matrix. Nevertheless, as this row was only added in order to include the power distribution inside A, we do not need to control the system along this "fake" dimension. That is, we only seek the control of the system in the first $ 2N $ dimensions of the space (N phase angles and N frequencies). Therefore, whenever $ rank[ W(T) ] = 2N$, we will use the Moore-Penrose pseudo inverse of the gramian $ W^\dagger(T) $ in the following.


\section{Results}


\bibliography{FilenameOfYourBibliography}




\end{document}

%%
%% EOF ieeepes_skel.tex
%%----------------------------------------------------------------------

